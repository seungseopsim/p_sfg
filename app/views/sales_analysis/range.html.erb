<%= content_for :metatage_includes do %>
  	<meta name="turbolinks-visit-control" content="reload">
<% end %>
<%= content_for :stylesheet_includes do %>
<style>
    .bootstrap-datetimepicker-widget.dropdown-menu {width: auto;}
	.datepicker table td a span,
    .datepicker table td,
    .datepicker table td span {
    height: 30px !important;
    line-height: 30px !important;
    vertical-align: center;
    width: auto !important;
    padding: 0px !important;
    }
	.move{
	left: 12px
	}
	.move-icon{
	position: relative;
	left: 12px;
	}
	.input-group .input-group-text {
	padding-left : 5px;
    background: transparent;
    border: 0;
    /* border-bottom: 1px solid #E1E1E1; */
    border-radius: 0;
    font-size: 20px;
    font-weight: 400;
    color: #141515;
    /* height: 40px; */
    width: auto;
    /* padding: 0 10px 0 0; */
	}
	
	.listview {
		display: block;
		padding: 0;
		margin: 0;
		color: #141515;
		background: #fff;
		border-top: 0px solid #E1E1E1;
		border-bottom: 0px solid #E1E1E1;
		line-height: 1.3em;
	}

	.listview > li:after {
		content: "";
		display: block;
		position: absolute;
		left: 0;
		right: 0;
		bottom: 0;
		height: 0px;
		background: #E1E1E1;
	}

	.listview_new {
		list-style:none;
		display: block;
		padding: 0;
		margin: 0;
		color: #141515;
		background: #fff;
		line-height: 1.3em;
	}

	.simple-listview .tabcontent > li .item {
		padding: 2px 18px;
		width: 100%;
		min-height: 30x;
		display: flex;
		align-items: center;
	}

	.simple-listview .tabcontent > li .item .s_item_in1{
		width: 35%;
		font-size:13px;
	}

	.simple-listview .tabcontent  > li .item .s_item_in2{
		/*text-align: center;
		*/
		width: 30%;

		text-align:right;
		padding-right:10px;
		font-size:13px;
	}		

	.card .card-body {
		padding: 7px;
		line-height: 1.4em;
	}

	.card .title {
		padding-top : 7px;
		margin-bottom : -10px;
	}


	.card .card-title {
		padding-left:7px;
		color: #141515;
		font-size: 18px;
		margin-top: .6rem;
		float:left;
		width: 55%;
	}

	.card .card-title_2 {
		padding-left:3.5rem;
		margin-top: .6rem;
		float:left;
		width: 45%;
	}


	.card .date {

	}

	.card .date .form-group_1 {
		padding: 5px 5px;
			float:left;
			width: 50%;
	}
	.card .date .form-group_2 {
		padding: 5px 5px;
			float:left;
			width: 50%;
			position: relative;
			left:-12px
	}

	.image-listview > li .item {
		padding: 0px 0px;
		width: 100%;
		min-height: 30px;
		display: flex;
		align-items: center;
	}

	.image-listview > li .item .in {
		display: flex;
		align-items: center;
		justify-content: space-between;
		width: 27%;
	}

	.card .listview .in1{

		padding-left : 15px;
		padding-right : 5px;
		display: flex;
		align-items: center;
		justify-content: space-between;
		width: 35%;
	}
	.card .listview .in1 .in1body{
		width: 100%;
	}

	.card .listview .in .in2body{
		width: 100%;
		margin-right: 0.6rem;
	}

	.card .listview .in1 .in1body .chip{
		height: 18px;
		line-height: 18px;
		display: block;
		text-align: center;
		font-size: 13px;

		width: 100%;
	}

	.card .listview .t{
		height: 18px;
		line-height: 18px;
		display: block;
		text-align:right;
		font-size: 13px;

	}

	.btn_body {
		padding: 7px;
	}

	.btn_body .btn {
		font-size: 13px;			
	}

	.toparea div{
		font-size: 13px;
		float:left;
		height: 17px;
		line-height: 17px;
		display: block;
	}
</style>
<% end %>

<%= content_for :javascript_includes do %>
<script type="text/javascript">;
	window.addEventListener('DOMContentLoaded', function(){
		const query = new URLSearchParams(window.location.search);
		const type = query.get('type');
		if(type == 1){
		document.getElementById('sum').className="badge badge-danger";		
		}else{
		document.getElementById('avr').className="badge badge-danger";
		}
	});

	function moverange(type)
	{
		inloader();
		window.location.href = "/analysis/range?start=<%=@startday%>&end=<%=@endday%>&type=" + type ;
	}

	function opentab(evt, itemname) {

		var i, tabcontent, tablinks;

		tabcontent = document.getElementsByClassName("tabcontent");

		for (i = 0; i < tabcontent.length; i++) {
			tabcontent[i].style.display = "none";
		}

		tablinks = document.getElementsByClassName("item");

		for (i = 0; i < tablinks.length; i++) {
			tablinks[i].className = tablinks[i].className.replace(" active", "");
		}

		target = document.getElementById(itemname);
		target.style.display = "block";
		target.className += " active";
	}

	$(function () { 
		$('#datetimepicker1').datetimepicker({ 
			format: "YYYY-MM-DD", 
			ignoreReadonly: true ,
			useCurrent: false,
			widgetPositioning: {
				horizontal: 'left',
				vertical: 'bottom'
			}
		}); 
			
		$('#datetimepicker2').datetimepicker({ 
			format: "YYYY-MM-DD", 
			ignoreReadonly: true ,
			useCurrent: false,
			widgetPositioning: {
				horizontal: 'left',
				vertical: 'bottom'
			}
		}); 

		$("#datetimepicker1").on("change.datetimepicker", function (e) { 
			$('#datetimepicker2').datetimepicker('minDate', e.date);
		}); 

		$("#datetimepicker2").on("change.datetimepicker", function (e) { 
			$('#datetimepicker1').datetimepicker('maxDate', e.date); 
		}); 

		$("#datetimepicker2").on("hide.datetimepicker", function (e) { 
		//alert("/analysis/range?start="+$("#datetimepicker1").find("input").val()+"&end="+$("#datetimepicker2").find("input").val());
			
			inloader();
			window.location.href = "/analysis/range?start="+$("#datetimepicker1").find("input").val()+"&end="+$("#datetimepicker2").find("input").val()+"&type=1";	
		}); 

	}); 

	$(document).ready(function() {
		opentab(event, "SFG");
	});	
</script>
<% end %>
	

<!-- App Header -->
<!-- <div class="appHeader bg-primary scrolled">-->
<div class="appHeader bg-primary text-light">
<div class="left">
		<a href="#" class="headerButton" data-toggle="modal" data-target="#sidebarPanel">
			<ion-icon name="menu-outline"></ion-icon>
		</a>
</div>
	<div class="pageTitle">매출 분석</div>
</div>
<!-- * App Header -->

<!-- App Capsule -->
<div id="appCapsule">
	<div class="section mt-1 mb-1">
		<div class="card">
			<div class="title">
			   <div class="card-title">기간 매출 (단위 만원)</div>
			   <div class="card-title_2">
					<span id="sum" class="badge badge-secondary" onclick="moverange('1')" >합</span>
					<span id="avr" class="badge badge-secondary" onclick="moverange('2')" >평균</span>
			   </div>
			</div>
			<div class="date">				
				<div class="form-group_1"> 
					<div class="input-group date" id="datetimepicker1" data-target-input="nearest"> 
						<input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1" required readonly="readonly" value="<%=@startday%>"> 
						<div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker"> 
							<div class="input-group-text">
								<i class="fa fa-calendar"></i>
							</div> 
						</div> 
					</div>  
				</div>
				<div class="form-group_2">  
					 <div class="input-group date" id="datetimepicker2" data-target-input="nearest"> 
						 <input type="text" class="form-control datetimepicker-input move" data-target="#datetimepicker2" required readonly="readonly" value="<%=@endday%>"> 
						 <div class="input-group-append move-icon" data-target="#datetimepicker2" data-toggle="datetimepicker"> 
							 <div class="input-group-text">
								 <i class="fa fa-calendar move"></i>
							 </div> 
						 </div> 
					 </div>
				</div>	
			 </div>
		</div>
	</div>


	<% if @rangetype == '1' %>
		<%= render 'sales_analysis/range/range.html.erb', {sfg: @sfg, business: @business, shops: @shops, startday: @startday, endday: @endday , 
		 startday_1: @startday_1, endday_1: @endday_1, startday_2: @startday_2, endday_2: @endday_2} %> 
	<% end %>

	<% if @rangetype == '2' %>
		<%= render 'sales_analysis/range/rangeavg.html.erb', {sfgavg: @sfgavg, businessavg: @businessavg, shopsavg: @shopsavg , startday: @startday, endday: @endday , 
		 startday_1: @startday_1, endday_1: @endday_1, startday_2: @startday_2, endday_2: @endday_2} %>
	<% end %>


</div>
<%= render 'layouts/sidebar', rooms: @roomtype %>
<%= render 'bottommenu' %>	
<script src="/assets/js/lib/popper.min.js"></script>
<script src="/assets/js/lib/bootstrap.min.js"></script>

